apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
metadata:
  name: arbitrary1

#commonLabels:
#  someName: someValue1
#  owner: alice1
#  app: bingo1

resources:
- ../../cluster-components-flux
- ../../cluster-components-flux/optional/charlie.yaml

#labels:
#  - pairs:
#      gwcp.guidewire.com/dept: '20'
#  - pairs:
#      atmos-cluster: alpaca

transformers:
  - ../../cluster-components-flux/label-patch.yaml

patches:
  - target:
      name: alpha
      kind: HelmRelease
    patch: |
      - op: replace
        path: /spec/values/replicaCount
        value: 2
#      - op: replace
#        path: /metadata/labels/gwcp.guidewire.com~1dept
#        value: 22
#      - op: add
#        path: /spec/postRenderers/0/kustomize/patches/-
#        value:
#          patch: |-
#            - op: replace
#              path: /metadata/labels/gwcp.guidewire.com~1dept
#              value: '23'
#          target:
#            name: .*
#            kind: .*
#      - op: add
#        path: /spec/postRenderers/0/kustomize/patches/-
#        value:
#          patch: |-
#            - op: replace
#              path: /spec/template/metadata/labels/gwcp.guidewire.com~1dept
#              value: '24'
#          target:
#            name: .*
#            kind: Deployment
  - target:
      name: bravo
      kind: HelmRelease
    patch: |
      - op: replace
        path: /spec/values/replicaCount
        value: 2
